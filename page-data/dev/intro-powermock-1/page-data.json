{"componentChunkName":"component---src-templates-blog-post-js","path":"/dev/intro-powermock-1/","result":{"data":{"site":{"siteMetadata":{"title":"bestalign's dev blog","categories":[{"displayText":"홈","priority":0,"name":"home","url":"/"},{"displayText":"TIL","priority":1,"name":"til","url":"/til"},{"displayText":"개발","priority":2,"name":"dev","url":"/dev"},{"displayText":"독서","priority":3,"name":"reading","url":"/reading"},{"displayText":"번역","priority":4,"name":"translation","url":"/translation"},{"displayText":"일기","priority":5,"name":"everydaylife","url":"/everydaylife"}]}},"markdownRemark":{"id":"7880e6a4-44cb-5747-9433-aa6593d68161","excerpt":"Mockito가 지원하는 기능은 간단한 기능의 유닛테스트에는 충분하지만 코드 구조가 복잡할 경우 테스트하기에 힘든 부분이 많다. 혹은 반대로, 테스트를 위해서 좋은 코드 구조를 포기해야만 하는 경우도 있다. PowerMock…","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 279px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f2b0006273357af44686a95b4b556869/3af37/powermock-logo.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABxUlEQVQoz3WQTUsbURSG5/9oxdgQglJt/4NCdK0gtRu7kCqail+ILoaUKFIsUotgaioujBvT0KkYiSjGfBmnGePEJDJFnTi5NzN37sy9mg6VVszh7M77nHPel6G1S9d1CKFpmpRSUq3HAqYWiTGORPb7+t709r7mOE4pK4QQwzD+3fEEbI0FQejvf2uzPW9qstts9u7uHkmSTEJ0rD/wT182TdPv/9ba+rKl5UVb2yuHw9ne3rG9HSyXgaqqGBukFmyZDAS26usbnM5mu93hcnUhhHj+VzKZUjVN1TRLwzwQ5G+bhkEpLRaLq1/9na6uumeN8XiCUrq7Gz7PXchyCVYqGFc1DJKv9ZJM/w+0BODBcQxBsOpbez84GInsB7+HNgNb0cPDWwAVpYwQIoQwpwueFDst/Qj+Dv9UMjwQs1d7O8nNjRwXOhp9l+NCSXbaw3q83rmlLyuJ5UXp6EDTdfwndob/6BXXfWcrS+l59nhsKOoeiE2OJKbcwqd5YXnxZGYsPDP+gWVHht2ffWux2Yn8uq/6peUZFi4opXI8CsQsEM9hPgfErJyKo5vrymUBiNmKdMmn0xkhkz7lr4SMWshb5D18BzUr+UDHk2AjAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"powermock logo\"\n        title=\"powermock logo\"\n        src=\"/static/f2b0006273357af44686a95b4b556869/3af37/powermock-logo.png\"\n        srcset=\"/static/f2b0006273357af44686a95b4b556869/c26ae/powermock-logo.png 158w,\n/static/f2b0006273357af44686a95b4b556869/3af37/powermock-logo.png 279w\"\n        sizes=\"(max-width: 279px) 100vw, 279px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Mockito가 지원하는 기능은 간단한 기능의 유닛테스트에는 충분하지만 코드 구조가 복잡할 경우 테스트하기에 힘든 부분이 많다. 혹은 반대로, 테스트를 위해서 좋은 코드 구조를 포기해야만 하는 경우도 있다. PowerMock은 그런 문제들을 피해 유닛테스트를 할 수 있게 도와준다. 이 글은 <a href=\"https://github.com/powermock/powermock/wiki\">PowerMock의 Wiki</a>를 보고 나름대로 정리한 것이다.</p>\n<p>이 글의 모든 예제 코드는 JUnit v4.12, PowerMock v1.6.6, Mockito v1.10.+ 을 기준으로 작성되었다. 추가로 PowerMock v1.6.6 기준으로 Mockito v2나 EasyMock도 지원한다. 공식 위키에 훨씬 더 자세한 내용이 있다.</p>\n<h2 id=\"setup\" style=\"position:relative;\"><a href=\"#setup\" aria-label=\"setup permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Setup</h2>\n<p>다음과 같이 <code class=\"language-text\">build.gradle</code>에 패키지를 추가하고 Gradle sync를 실행하자. 순서대로 JUnit v4.12,  PowerMock v1.6.6, 그리고 PowerMock v1.6.6과 호환되는 Mockito 버전(작성기준 v1.10.19)을 설치한다. </p>\n<div class=\"gatsby-highlight\" data-language=\"groovy\"><pre class=\"language-groovy\"><code class=\"language-groovy\"><span class=\"token comment\">// omitted for readability</span>\n\nrepositories <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">mavenCentral</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\ndependencies <span class=\"token punctuation\">{</span>\n    testCompile group<span class=\"token punctuation\">:</span> <span class=\"token string\">'junit'</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">:</span> <span class=\"token string\">'junit'</span><span class=\"token punctuation\">,</span> version<span class=\"token punctuation\">:</span> <span class=\"token string\">'4.12'</span>\n    testCompile <span class=\"token string gstring\">\"org.powermock:powermock-module-junit4:1.6.6\"</span>\n    testCompile <span class=\"token string gstring\">\"org.powermock:powermock-api-mockito:1.6.6\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>또, PowerMock을 JUnit test에 사용하기 위해 <code class=\"language-text\">@RunWith(PowerMockRunner.class)</code> Annotation을 원하는 Test class에 추가해주자.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@RunWith</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">PowerMockRunner</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// set PowerMockRunner here!</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">UnitTest</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token annotation punctuation\">@Test</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// test code here</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"캡슐화-우회-bypass-encapsulation\" style=\"position:relative;\"><a href=\"#%EC%BA%A1%EC%8A%90%ED%99%94-%EC%9A%B0%ED%9A%8C-bypass-encapsulation\" aria-label=\"캡슐화 우회 bypass encapsulation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>캡슐화 우회 (Bypass Encapsulation)</h2>\n<p>캡슐화 우회를 위한 메소드들은 모두 <code class=\"language-text\">org.powermock.reflect.Whitebox</code> 패키지에 정의되어 있다. 패키지의 이름에서도 알 수 있듯이 모든 기능은 리플랙션(reflection)으로 만들어졌다. 사실 이 패키지를 사용하지 않고도 직접 리플랙션 코드로 private 필드나 메소드에 접근할 수 있다. 하지만 역시 이런 세세한 기능을 직접 만드려면 수고가 많이 들기 때문에 Powermock을 사용하는 것을 추천한다.</p>\n<h3 id=\"private-field-access\" style=\"position:relative;\"><a href=\"#private-field-access\" aria-label=\"private field access permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Private field access</h3>\n<p>Getter나 setter가 없어서 private 필드에 접근이 불가능 할 때 <code class=\"language-text\">setInternalState()</code>/<code class=\"language-text\">getInternalState()</code>메소드를 이용하면 접근이 가능하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">PrivateField</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> secretField<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/////////////////////////////////////////////////////////////////////</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>powermock<span class=\"token punctuation\">.</span>reflect<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Whitebox</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token annotation punctuation\">@RunWith</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">PowerMockRunner</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">PrivateFieldTest</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token annotation punctuation\">@Test</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">accessPrivateFieldByName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">PrivateField</span> pf <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PrivateField</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">Whitebox</span><span class=\"token punctuation\">.</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span><span class=\"token function\">setInternalState</span><span class=\"token punctuation\">(</span>pf<span class=\"token punctuation\">,</span> <span class=\"token string\">\"secretField\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"secret value\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">String</span> s <span class=\"token operator\">=</span> <span class=\"token class-name\">Whitebox</span><span class=\"token punctuation\">.</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span><span class=\"token function\">getInternalState</span><span class=\"token punctuation\">(</span>pf<span class=\"token punctuation\">,</span> <span class=\"token string\">\"secretField\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">Assert</span><span class=\"token punctuation\">.</span><span class=\"token function\">assertEquals</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"secret value\"</span><span class=\"token punctuation\">,</span> s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token annotation punctuation\">@Test</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">accessPrivateFieldByType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">PrivateField</span> pf <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PrivateField</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">Whitebox</span><span class=\"token punctuation\">.</span><span class=\"token function\">setInternalState</span><span class=\"token punctuation\">(</span>pf<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"secret value\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">String</span> s <span class=\"token operator\">=</span> <span class=\"token class-name\">Whitebox</span><span class=\"token punctuation\">.</span><span class=\"token function\">getInternalState</span><span class=\"token punctuation\">(</span>pf<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">Assert</span><span class=\"token punctuation\">.</span><span class=\"token function\">assertEquals</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"secret value\"</span><span class=\"token punctuation\">,</span> s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>이름</strong> 혹은 <strong>타입</strong>으로 특정 private 필드에 접근한다. 필드 타입으로 접근하면 코드를 짤 때는 손쉽지만, 따로 주석을 달아놓지 않는 이상 나중에 테스트 코드를 수정할 때 어느 필드에 접근하는 건지 바로 알기 어렵다는 단점이 있다. 또, 같은 타입의 필드가 여러개 있을 경우 타입으로 접근하는 것이 불가능하다. 코드가 조금 더 길어지더라도 필드 이름으로 접근하는 것이 길게 봤을 때 좋다.</p>\n<h3 id=\"private-method-invocation\" style=\"position:relative;\"><a href=\"#private-method-invocation\" aria-label=\"private method invocation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Private method invocation</h3>\n<p><code class=\"language-text\">invokeMethod()</code>로 private 메소드를 호출할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">PrivateMethod</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> <span class=\"token function\">sum</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> x<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> y<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> x <span class=\"token operator\">+</span> y<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/////////////////////////////////////////////////////////////////////</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>powermock<span class=\"token punctuation\">.</span>reflect<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Whitebox</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token annotation punctuation\">@RunWith</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">PowerMockRunner</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">PrivateMethodTest</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token annotation punctuation\">@Test</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">invokePrivateMethodByName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">PrivateMethod</span> pm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PrivateMethod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> sum <span class=\"token operator\">=</span> <span class=\"token class-name\">Whitebox</span><span class=\"token punctuation\">.</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span><span class=\"token function\">invokeMethod</span><span class=\"token punctuation\">(</span>pm<span class=\"token punctuation\">,</span> <span class=\"token string\">\"sum\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">Assert</span><span class=\"token punctuation\">.</span><span class=\"token function\">assertEquals</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> sum<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token annotation punctuation\">@Test</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">invokePrivateMethodWithoutName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">PrivateMethod</span> pm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PrivateMethod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> sum <span class=\"token operator\">=</span> <span class=\"token class-name\">Whitebox</span><span class=\"token punctuation\">.</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Integer</span><span class=\"token punctuation\">></span></span><span class=\"token function\">invokeMethod</span><span class=\"token punctuation\">(</span>pm<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// without method name</span>\n    <span class=\"token class-name\">Assert</span><span class=\"token punctuation\">.</span><span class=\"token function\">assertEquals</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> sum<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>private 필드를 <strong>이름</strong> 혹은 <strong>타입</strong>으로 찾는 것처럼, <code class=\"language-text\">invokeMethod()</code>는 <strong>이름</strong> 또는 <strong>메소드 파라미터 타입</strong>으로 메소드를 찾는다. 같은 파라미터 타입을 가진 메소드가 또 있으면 호출이 불가능하므로 이름까지 꼭 적어주는 편이 좋다.</p>\n<h3 id=\"super-class-private-field-access--method-invocation\" style=\"position:relative;\"><a href=\"#super-class-private-field-access--method-invocation\" aria-label=\"super class private field access  method invocation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Super class’ private field access / method invocation</h3>\n<p>심지어 오버라이드(override)되어서 직접 접근할 수 없는 부모 클래스의 필드나 메소드에도 접근이 가능하다. 위의 예제들과 똑같이 <code class=\"language-text\">setInternalState()</code>/<code class=\"language-text\">getInternalState()</code>/<code class=\"language-text\">invokeMethod()</code>메소드를 사용한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">PrivateParentClass</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> secretField<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">secretMethod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        secretField <span class=\"token operator\">=</span> <span class=\"token string\">\"parent method called!\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">PrivateChildClass</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">PrivateParentClass</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> secretField<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">secretMethod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> \n        secretField <span class=\"token operator\">=</span> <span class=\"token string\">\"child method called!\"</span><span class=\"token punctuation\">;</span> \n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/////////////////////////////////////////////////////////////////////</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>powermock<span class=\"token punctuation\">.</span>reflect<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Whitebox</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token annotation punctuation\">@RunWith</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">PowerMockRunner</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">PrivateSuperFieldTest</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token annotation punctuation\">@Test</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">accessPrivateSuperFieldByName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">PrivateChildClass</span> pcc <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PrivateChildClass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">Whitebox</span><span class=\"token punctuation\">.</span><span class=\"token function\">setInternalState</span><span class=\"token punctuation\">(</span>pcc<span class=\"token punctuation\">,</span> <span class=\"token string\">\"secretField\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"child field accessed!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">Whitebox</span><span class=\"token punctuation\">.</span><span class=\"token function\">setInternalState</span><span class=\"token punctuation\">(</span>pcc<span class=\"token punctuation\">,</span> <span class=\"token string\">\"secretField\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"parent field accessed!\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">PrivateParentClass</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">String</span> childField <span class=\"token operator\">=</span> <span class=\"token class-name\">Whitebox</span><span class=\"token punctuation\">.</span><span class=\"token function\">getInternalState</span><span class=\"token punctuation\">(</span>pcc<span class=\"token punctuation\">,</span> <span class=\"token string\">\"secretField\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">String</span> parentField <span class=\"token operator\">=</span> <span class=\"token class-name\">Whitebox</span><span class=\"token punctuation\">.</span><span class=\"token function\">getInternalState</span><span class=\"token punctuation\">(</span>pcc<span class=\"token punctuation\">,</span> <span class=\"token string\">\"secretField\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">PrivateParentClass</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">Assert</span><span class=\"token punctuation\">.</span><span class=\"token function\">assertEquals</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"child field accessed!\"</span><span class=\"token punctuation\">,</span> childField<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">Assert</span><span class=\"token punctuation\">.</span><span class=\"token function\">assertEquals</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"parent field accessed!\"</span><span class=\"token punctuation\">,</span> parentField<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token annotation punctuation\">@Test</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">invokePrivateSuperMethod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">PrivateChildClass</span> pcc <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PrivateChildClass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">Whitebox</span><span class=\"token punctuation\">.</span><span class=\"token function\">invokeMethod</span><span class=\"token punctuation\">(</span>pcc<span class=\"token punctuation\">,</span><span class=\"token string\">\"secretMethod\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">Whitebox</span><span class=\"token punctuation\">.</span><span class=\"token function\">invokeMethod</span><span class=\"token punctuation\">(</span>pcc<span class=\"token punctuation\">,</span> <span class=\"token class-name\">PrivateParentClass</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"secretMethod\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">String</span> childField <span class=\"token operator\">=</span> <span class=\"token class-name\">Whitebox</span><span class=\"token punctuation\">.</span><span class=\"token function\">getInternalState</span><span class=\"token punctuation\">(</span>pcc<span class=\"token punctuation\">,</span> <span class=\"token string\">\"secretField\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">String</span> parentField <span class=\"token operator\">=</span> <span class=\"token class-name\">Whitebox</span><span class=\"token punctuation\">.</span><span class=\"token function\">getInternalState</span><span class=\"token punctuation\">(</span>pcc<span class=\"token punctuation\">,</span> <span class=\"token string\">\"secretField\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">PrivateParentClass</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">Assert</span><span class=\"token punctuation\">.</span><span class=\"token function\">assertEquals</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"child method called!\"</span><span class=\"token punctuation\">,</span> childField<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">Assert</span><span class=\"token punctuation\">.</span><span class=\"token function\">assertEquals</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"parent method called!\"</span><span class=\"token punctuation\">,</span> parentField<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>기존과 똑같이 사용하지만 접근하려는 특정 클래스 타입을 추가 파라미터로 넣어주면 된다. 일반적으로 오버라이드된 필드나 메소드를 접근할 일은 거의 없어서 그냥 이런 기능이 있다 정도만 알아두면 될 듯하다.</p>\n<h3 id=\"private-constructor-invocation\" style=\"position:relative;\"><a href=\"#private-constructor-invocation\" aria-label=\"private constructor invocation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Private constructor invocation</h3>\n<p>자주 사용할 일은 없겠지만 private 생성자를 직접 호출하는 것도 가능하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">PrivateConstructor</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> val<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token class-name\">PrivateConstructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>val <span class=\"token operator\">=</span> <span class=\"token number\">42</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token class-name\">PrivateConstructor</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> val<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>val <span class=\"token operator\">=</span> val<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">int</span> <span class=\"token function\">getVal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>val<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/////////////////////////////////////////////////////////////////////</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>powermock<span class=\"token punctuation\">.</span>reflect<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Whitebox</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token annotation punctuation\">@RunWith</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">PowerMockRunner</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">PrivateConstructorTest</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token annotation punctuation\">@Test</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">privateConstructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">PrivateConstructor</span> pc <span class=\"token operator\">=</span> <span class=\"token class-name\">Whitebox</span><span class=\"token punctuation\">.</span><span class=\"token function\">invokeConstructor</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">PrivateConstructor</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">Assert</span><span class=\"token punctuation\">.</span><span class=\"token function\">assertEquals</span><span class=\"token punctuation\">(</span><span class=\"token number\">42</span><span class=\"token punctuation\">,</span> pc<span class=\"token punctuation\">.</span><span class=\"token function\">getVal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token annotation punctuation\">@Test</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">privateConstructorWithArgs</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">PrivateConstructor</span> pc <span class=\"token operator\">=</span> <span class=\"token class-name\">Whitebox</span><span class=\"token punctuation\">.</span><span class=\"token function\">invokeConstructor</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">PrivateConstructor</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token number\">43</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">Assert</span><span class=\"token punctuation\">.</span><span class=\"token function\">assertEquals</span><span class=\"token punctuation\">(</span><span class=\"token number\">43</span><span class=\"token punctuation\">,</span> pc<span class=\"token punctuation\">.</span><span class=\"token function\">getVal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"관련글\" style=\"position:relative;\"><a href=\"#%EA%B4%80%EB%A0%A8%EA%B8%80\" aria-label=\"관련글 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>관련글</h2>\n<ul>\n<li><a href=\"/intro-mockito-1\">Mockito 사용하기 1</a></li>\n<li><a href=\"/intro-mockito-2\">Mockito 사용하기 2</a></li>\n</ul>","frontmatter":{"title":"PowerMock 사용하기 1","category":"dev","date":"May 07, 2017","updated":null,"description":null,"tags":["Java","Mockito","PowerMock","Unit Test"]}},"previous":{"fields":{"slug":"/dev/favor-use-of-standard-exceptions/"},"frontmatter":{"title":"Method Parameter and Exception Handling"}},"next":{"fields":{"slug":"/dev/hexo-to-gatsby-migration-1/"},"frontmatter":{"title":"Hexo에서 Gatsby로 플랫폼 이전하기 1"}}},"pageContext":{"id":"7880e6a4-44cb-5747-9433-aa6593d68161","previousPostId":"ebc8238f-3ef7-5663-bbfc-fd8f6d0572f0","nextPostId":"ceb2dfac-c3f6-52b1-a9ad-3f882482c16b"}},"staticQueryHashes":["2841359383"]}